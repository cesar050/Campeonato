<div class="auth-layout">
  <!-- LEFT SIDE -->
  <div class="auth-side">
    <div class="auth-brand">
      <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <path d="M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"></path>
        <path d="M2 12h20"></path>
      </svg>
      <span>Campeonato Libre</span>
    </div>

    <img src="assets/images/Principal.png" alt="Campeonato Libre" class="auth-image">

    <div class="auth-tagline">
      <h2>La gestión de tu liga, simplificada.</h2>
      <p>Enfócate en el juego, nosotros nos encargamos del resto.</p>
    </div>

    <div class="auth-footer">
      © 2024 Campeonato Libre. Todos los derechos reservados.
    </div>
  </div>

  <!-- RIGHT SIDE -->
  <div class="auth-form-container">
    <div class="auth-form-wrapper">
      <!-- STEP 1: EMAIL -->
      @if (step() === 'email') {
        <div class="step-content">
          <div class="icon-circle">
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
              <path d="M7 11V7a5 5 0 0 1 9.9-1"></path>
            </svg>
          </div>

          <h1>¿Olvidaste tu contraseña?</h1>
          <p class="auth-subtitle">No te preocupes. Ingresa tu email y te enviaremos un código de verificación.</p>

          @if (errorMessage()) {
            <div class="alert alert-error">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="8" x2="12" y2="12"></line>
                <line x1="12" y1="16" x2="12.01" y2="16"></line>
              </svg>
              <div>
                <strong>Error</strong>
                <p>{{ errorMessage() }}</p>
              </div>
            </div>
          }

          <form [formGroup]="emailForm" (ngSubmit)="sendCode()">
            <div class="form-group">
              <label for="email">Correo Electrónico</label>
              <div class="input-wrapper">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="input-icon">
                  <rect x="2" y="4" width="20" height="16" rx="2"></rect>
                  <path d="m2 7 10 7 10-7"></path>
                </svg>
                <input 
                  type="email" 
                  id="email" 
                  formControlName="email" 
                  placeholder="tu.correo@ejemplo.com">
              </div>
            </div>

            <button type="submit" class="btn-submit" [disabled]="isLoading()">
              @if (isLoading()) {
                <span class="spinner"></span>
                Enviando Código...
              } @else {
                Enviar Código
              }
            </button>

            <a routerLink="/auth/login" class="link-back">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M19 12H5M12 19l-7-7 7-7"/>
              </svg>
              Volver al inicio de sesión
            </a>
          </form>
        </div>
      }

      <!-- STEP 2: CODE & NEW PASSWORD -->
      @if (step() === 'code') {
        <div class="step-content">
          <div class="icon-circle">
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="2" y="4" width="20" height="16" rx="2"></rect>
              <path d="m2 7 10 7 10-7"></path>
            </svg>
          </div>

          <h1>Revisa tu Email</h1>
          <p class="auth-subtitle">Código enviado a <strong>{{ maskedEmail() }}</strong></p>

          @if (errorMessage()) {
            <div class="alert alert-error">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="8" x2="12" y2="12"></line>
                <line x1="12" y1="16" x2="12.01" y2="16"></line>
              </svg>
              <div>
                <strong>Error</strong>
                <p>{{ errorMessage() }}</p>
              </div>
            </div>
          }

          <form [formGroup]="resetForm" (ngSubmit)="resetPassword()">
            <!-- CODE -->
            <div class="form-group">
              <label for="code">Código de Verificación</label>
              <input 
                type="text" 
                id="code" 
                formControlName="code" 
                placeholder="000000"
                maxlength="6"
                class="code-input">
            </div>

            <!-- NEW PASSWORD -->
            <div class="form-group">
              <label for="new_password">Nueva Contraseña</label>
              <div class="input-wrapper">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="input-icon">
                  <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                  <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                </svg>
                <input 
                  [type]="showPassword() ? 'text' : 'password'" 
                  id="new_password" 
                  formControlName="new_password"
                  placeholder="••••••••">
                <button type="button" class="toggle-password" (click)="togglePassword()">
                  @if (showPassword()) {
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
                      <line x1="1" y1="1" x2="23" y2="23"></line>
                    </svg>
                  } @else {
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                      <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                  }
                </button>
              </div>
            </div>

            <!-- CONFIRM PASSWORD -->
            <div class="form-group">
              <label for="confirm_password">Confirmar Contraseña</label>
              <div class="input-wrapper">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="input-icon">
                  <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                  <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                </svg>
                <input 
                  [type]="showConfirmPassword() ? 'text' : 'password'" 
                  id="confirm_password" 
                  formControlName="confirm_password"
                  placeholder="••••••••">
                <button type="button" class="toggle-password" (click)="toggleConfirmPassword()">
                  @if (showConfirmPassword()) {
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
                      <line x1="1" y1="1" x2="23" y2="23"></line>
                    </svg>
                  } @else {
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                      <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                  }
                </button>
              </div>
            </div>

            <button type="submit" class="btn-submit" [disabled]="isLoading()">
              @if (isLoading()) {
                <span class="spinner"></span>
                Restableciendo...
              } @else {
                Restablecer Contraseña
              }
            </button>

            <button type="button" class="btn-secondary" (click)="changeEmail()">
              Cambiar Email
            </button>
          </form>
        </div>
      }

      <!-- STEP 3: SUCCESS -->
      @if (step() === 'success') {
        <div class="success-state">
          <div class="success-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
              <polyline points="22 4 12 14.01 9 11.01"></polyline>
            </svg>
          </div>
          <h2>¡Contraseña Actualizada!</h2>
          <p>Ya puedes iniciar sesión con tu nueva contraseña</p>
          <button type="button" class="btn-submit" (click)="goToLogin()">
            Ir a Iniciar Sesión
          </button>
        </div>
      }
    </div>
  </div>
</div>